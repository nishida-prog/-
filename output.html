<!doctype html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{meta.title}}</title>
  <style>
    :root {
      --border: {{styles.colors.border}};
      --lane-bg: {{styles.colors.lane_bg}};
      --body-bg: {{styles.colors.body_bg}};
      --text-color: {{styles.colors.text}};
      --lane-border: {{styles.lane_border}}px;
      --font-family: {{styles.font_family}};
      --stair-step-x: 10mm;   /* 1.0cm spacing */
      --stair-step-y: 10mm;   /* 1.0cm spacing */
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: var(--font-family);
      background: var(--body-bg);
      color: var(--text-color);
    }
    main {
      width: {{layout.grid.width}}px;
      margin: 10px auto 20px;
    }
    .legend {
      width: {{layout.grid.width}}px;
      margin: 0 auto 10px;
      font-size: 13px;
      color: var(--text-color);
    }
    .legend-item {
      display: inline-flex;
      align-items: center;
      margin-right: 16px;
    }
    .legend-item:last-of-type { margin-right: 0; }
    .legend-swatch {
      width: 14px;
      height: 14px;
      border: 1px solid #999;
      border-radius: 2px;
      margin-right: 6px;
    }
    .grid {
      position: relative;
      width: {{layout.grid.width}}px;
      min-height: {{layout.grid.height}}px;
      overflow-x: auto;
      overflow-y: auto;
    }
    .lanes-layer {
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: var(--stair-step-y);
      padding: 0;
      margin: 0;
    }
    .lane {
      position: relative;
      border: var(--lane-border) solid var(--border);
      background: var(--lane-bg);
      color: var(--text-color);
      padding: 6px;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      gap: 8px;
      height: auto;
      min-height: fit-content;
      width: auto;
      margin-left: calc(var(--lane-index, 0) * var(--stair-step-x));
      margin-top: 0;
      min-width: min-content;
    }
    .lane::before,
    .lane::after {
      content: "";
      position: absolute;
      background: var(--border);
      opacity: 0.8;
    }
    .lane:not(:last-child)::before {
      left: 50%;
      bottom: calc(-1 * var(--stair-step-y));
      width: 2px;
      height: var(--stair-step-y);
      transform: translateX(-50%);
    }
    .lane:not(:last-child)::after {
      left: 50%;
      bottom: calc(-1 * var(--stair-step-y));
      width: var(--stair-step-x);
      height: 2px;
      transform: translateX(-50%);
    }
    .lane-title {
      display: block;
      color: var(--border);
      font-weight: 700;
      font-size: 15px;
      margin-bottom: 6px;
    }
    .lane-group {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 6px;
    }
    .card {
      display: inline-flex;
      align-items: center;
      padding: 6px 10px;
      border-radius: 3px;
      border: 1px solid var(--border);
      font-size: 13px;
      font-weight: 700;
      margin: 4px 6px 4px 0;
      color: #000;
      white-space: normal;
      line-height: 1.3;
      word-break: keep-all;
      max-width: calc(100% - 12px);
      min-width: 64px;
    }
    .lane-group .card { display: flex; margin: 0; }
{{#styles.types}}
    .card.type-{{key}} { background: {{color}}; }
{{/styles.types}}
  </style>
</head>
<body>
  <main aria-live="polite">
    <div class="legend">
{{#legend.items}}
      <span class="legend-item"><span class="legend-swatch" style="background: {{color}}; border-color: {{border}};"></span>{{label}}</span>
{{/legend.items}}
    </div>
    <div class="grid">
      <div class="lanes-layer">
{{#lanes}}
        <section class="lane" style="--lane-index: {{lane_index}}; width: {{width}}px; min-width: {{width}}px;{{#height}} min-height: {{height}}px;{{/height}}">
          <span class="lane-title">{{label}}</span>
{{#groups}}
          <div class="lane-group"{{#marginTop}} style="margin-top: {{marginTop}}px;"{{/marginTop}}>
{{#items}}
            <div class="card{{#type}} type-{{type}}{{/type}}" style="{{#block}}display:block;{{/block}}{{#marginTop}} margin-top: {{marginTop}}px;{{/marginTop}}{{#marginLeft}} margin-left: {{marginLeft}}px;{{/marginLeft}}">{{label}}</div>
{{/items}}
          </div>
{{/groups}}
        </section>
{{/lanes}}
      </div>
    </div>
  </main>
</body>
</html>
