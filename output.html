<!doctype html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{meta.title}}</title>
  <style>
    :root {
      --border: {{styles.colors.border}};
      --lane-bg: {{styles.colors.lane_bg}};
      --body-bg: {{styles.colors.body_bg}};
      --text-color: {{styles.colors.text}};
      --lane-border: {{styles.lane_border}}px;
      {{#styles.types}}
      --type-{{key}}: {{color}};
      {{/styles.types}}
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Hiragino Sans", "Noto Sans JP", sans-serif;
      background: var(--body-bg);
      color: var(--text-color);
    }
    main {
      width: {{layout.grid.width}}px;
      margin: 10px auto 20px;
    }
    .legend {
      width: {{layout.grid.width}}px;
      margin: 0 auto 10px;
      font-size: 13px;
      color: var(--text-color);
    }
    .legend-item {
      display: inline-flex;
      align-items: center;
      margin-right: 16px;
    }
    .legend-item:last-of-type {
      margin-right: 0;
    }
    .legend-swatch {
      width: 14px;
      height: 14px;
      border: 1px solid #999;
      border-radius: 2px;
      margin-right: 6px;
    }
    {{#styles.types}}
    .legend-swatch.type-{{key}} { background: var(--type-{{key}}); }
    {{/styles.types}}
    .legend-swatch.lane { background: var(--lane-bg); border-color: var(--border); }
    .legend-swatch.border { background: #ffffff; border-color: var(--border); }
    .grid {
      position: relative;
      width: {{layout.grid.width}}px;
      height: {{layout.grid.height}}px;
    }
    .lanes-layer {
      position: absolute;
      inset: 0;
    }
    .lane {
      position: absolute;
      border: var(--lane-border) solid var(--border);
      background: var(--lane-bg);
      color: var(--text-color);
      padding: 6px;
      box-sizing: border-box;
    }
    .lane-title {
      display: block;
      color: var(--border);
      font-weight: 700;
      font-size: 15px;
      margin-bottom: 6px;
    }
    .card {
      display: inline-flex;
      align-items: center;
      padding: 6px 10px;
      border-radius: 3px;
      border: 1px solid var(--border);
      font-size: 13px;
      font-weight: 700;
      margin: 4px 6px 4px 0;
      color: #000;
      white-space: normal;
      line-height: 1.3;
      word-break: keep-all;
      max-width: calc(100% - 12px);
      min-width: 64px;
    }
    {{#styles.types}}
    .card.type-{{key}} { background: var(--type-{{key}}); }
    {{/styles.types}}
    .arrows {
      position: absolute;
      top: 0;
      left: 0;
      pointer-events: none;
      overflow: visible;
    }
    .arrows path {
      stroke: var(--border);
      stroke-width: 2.2;
      fill: none;
      marker-end: url(#arrowhead);
    }
  </style>
</head>
<body>
  <main>
    <div class="legend" aria-live="polite">
      {{#styles.types}}
      <span class="legend-item">
        <span class="legend-swatch type-{{key}}"></span>{{label}}
      </span>
      {{/styles.types}}
      {{#legend.items}}
      <span class="legend-item">
        <span class="legend-swatch {{key}}"></span>{{label}}
      </span>
      {{/legend.items}}
    </div>
    <div class="grid">
      <svg class="arrows" width="{{layout.grid.width}}" height="{{layout.grid.height}}" viewBox="0 0 {{layout.grid.width}} {{layout.grid.height}}" aria-hidden="true">
        <defs>
          <marker id="arrowhead" markerWidth="10" markerHeight="8" refX="9" refY="4" orient="auto" markerUnits="strokeWidth">
            <polygon points="0 0, 10 4, 0 8" fill="var(--border)"></polygon>
          </marker>
        </defs>
        {{#arrows}}
        <path d="{{path}}"></path>
        {{/arrows}}
      </svg>
      <div class="lanes-layer">
        {{#lanes}}
        <section class="lane" style="left:{{x}}px; top:{{y}}px; width:{{width}}px;{{#height}} height:{{height}}px;{{/height}}">
          <span class="lane-title">{{label}}</span>
          {{#groups}}
          <div{{#marginTop}} style="margin-top: {{marginTop}}px;"{{/marginTop}}>
            {{#items}}
            <div class="card type-{{type}}" style="{{#block}}display:block;{{/block}}{{#marginTop}}margin-top: {{marginTop}}px;{{/marginTop}}{{#marginLeft}}margin-left: {{marginLeft}}px;{{/marginLeft}}">{{label}}</div>
            {{/items}}
          </div>
          {{/groups}}
        </section>
        {{/lanes}}
      </div>
    </div>
  </main>
</body>
</html>
